## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Load libraries
library(dplyr)
library(readr)
library(readxl)
library(tidyr)
library(filesstrings)


## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
df <- read.csv('http://files.zillowstatic.com/research/public/County/County_MedianListingPrice_AllHomes.csv')
head(df)


## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
df_nc <- filter(df, State == 'NC')
head(df_nc)


## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
colnames(df_nc) <- sub("X","", colnames(df_nc))

head(df_nc)


## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
df_nc$MunicipalCodeFIPS <- sprintf("%03d", df_nc$MunicipalCodeFIPS)



## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
head(df_nc)


## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
df_nc$MunicipalCodeFIPS <- as.character(df_nc$MunicipalCodeFIPS)
df_nc$StateCodeFIPS <- as.character(df_nc$StateCodeFIPS)
head(df_nc)


## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
rownames(df_nc) <- df_nc$RegionName
head(df_nc)


## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
df_nc <- select(df_nc, -RegionName)


## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
df_nc[is.na(df_nc)] <- 0

head(df_nc)


## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
write.table(df_nc, file="STG_ZLLW_County_Median_Listing_Price_All_Homes.txt", sep='\t')


## --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
file.move("STG_ZLLW_County_Median_Listing_Price_All_Homes.txt", "../Updates/", overwrite=TRUE)

